### Add EVE sequences to constrained alignment tree

alignment AL_RT_Root_MASTER

  add member -w "source.name = 'fasta-ehbv-curated'"
  add member -w "source.name = 'fasta-ehbv-refseqs'"

  #extract child AL_HEART -r REF_HEART
  #demote member AL_HEART --whereClause "sequence.family = 'HEART'"

  demote member AL_Hepadnaviridae_MASTER -w "sequence.source.name = 'fasta-ehbv-curated' and sequence.family = 'Hepadnaviridae'"
  demote member AL_Hepadnaviridae_MASTER -w "sequence.source.name = 'fasta-ehbv-refseqs' and sequence.family = 'Hepadnaviridae'"
  exit


#~# EVEs derived from hepadnaviruses
alignment AL_Hepadnaviridae_MASTER

  demote member AL_Hepadna_Env -w "sequence.genus = 'Orthohepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Orthohepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Avihepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Avihepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Herpetohepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Herpetohepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Metahepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Metahepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Parahepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Hepadna_Env -w "sequence.genus = 'Parahepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"
  
  demote member AL_Nakedna -w "sequence.genus = 'Nackednavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Nakedna -w "sequence.genus = 'Nackednavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"
  exit

#~# EVEs derived from enveloped hepadnaviruses
alignment AL_Hepadna_Env
  
  demote member AL_Orthohepadna -w "sequence.genus = 'Orthohepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Orthohepadna -w "sequence.genus = 'Orthohepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"

  demote member AL_Avihepadna -w "sequence.genus = 'Avihepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Avihepadna -w "sequence.genus = 'Avihepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"

  demote member AL_Herpetohepadna -w "sequence.genus = 'Herpetohepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Herpetohepadna -w "sequence.genus = 'Herpetohepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"

  demote member AL_Metahepadna -w "sequence.genus = 'Metahepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Metahepadna -w "sequence.genus = 'Metahepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'"

  demote member AL_Parahepadna -w "sequence.genus = 'Parahepadnavirus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_Parahepadna -w "sequence.genus = 'Parahepadnavirus' and sequence.source.name = 'fasta-ehbv-refseqs'" 
  exit

#~# Avian EVE aligns
alignment AL_Avihepadna

  extract child AL_eHBV-Avi.1-Aves -r REF_EHBV-Ave.1-neognathae
  demote member AL_eHBV-Avi.1-Aves -w "sequence.name = 'eHBV-Avi.1-Aves' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_eHBV-Avi.1-Aves -w "sequence.name = 'eHBV-Avi.1-Aves' and sequence.source.name = 'fasta-ehbv-refseqs'"

  extract child AL_eHBV-Avi.2-Psittaciformes -r REF_EHBV-Ave.1-neognathae
  demote member AL_eHBV-Avi.2-Psittaciformes -w "sequence.name = 'eHBV-Avi.2-Psittaciformes' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_eHBV-Avi.2-Psittaciformes -w "sequence.name = 'eHBV-Avi.2-Psittaciformes' and sequence.source.name = 'fasta-ehbv-refseqs'"
  exit

#~# Herpeto EVE aligns
alignment AL_Herpetohepadna

  extract child AL_eHBV-Herpeto.1-Serpentes -r REF_eHBV-Herpeto.1-Serpentes
  demote member AL_eHBV-Herpeto.1-Serpentes -w "sequence.name = 'eHBV-Herpeto.1-Serpentes' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_eHBV-Herpeto.1-Serpentes -w "sequence.name = 'eHBV-Herpeto.1-Serpentes' and sequence.source.name = 'fasta-ehbv-refseqs'"

  #extract child AL_eHBV-Herpeto.2-Serpentes -r REF_eHBV-Herpeto.2-Serpentes
  #demote member AL_eHBV-Herpeto.2-Serpentes -w "sequence.name = 'eHBV-Herpeto.2-Serpentes' and sequence.source.name = 'fasta-ehbv-curated'"
  #demote member AL_eHBV-Herpeto.2-Serpentes -w "sequence.name = 'eHBV-Herpeto.2-Serpentes' and sequence.source.name = 'fasta-ehbv-refseqs'"

  extract child AL_eHBV-Herpeto.3-Crocodilia -r REF_eHBV-Herpeto.3-Crocodilia
  demote member AL_eHBV-Herpeto.3-Crocodilia -w "sequence.name = 'eHBV-Herpeto.3-Crocodilia' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_eHBV-Herpeto.3-Crocodilia -w "sequence.name = 'eHBV-Herpeto.3-Crocodilia' and sequence.source.name = 'fasta-ehbv-refseqs'"

  extract child AL_eHBV-Herpeto.5-Testudines -r REF_eHBV-Herpeto.5-Testudines
  demote member AL_eHBV-Herpeto.5-Testudines -w "sequence.name = 'eHBV-Herpeto.5-Testudines' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_eHBV-Herpeto.5-Testudines -w "sequence.name = 'eHBV-Herpeto.5-Testudines' and sequence.source.name = 'fasta-ehbv-refseqs'"

  extract child AL_eHBV-Herpeto.6-Varanus -r REF_eHBV-Herpeto.6-Varanus
  demote member AL_eHBV-Herpeto.6-Varanus -w "sequence.name = 'eHBV-Herpeto.6-Varanus' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_eHBV-Herpeto.6-Varanus -w "sequence.name = 'eHBV-Herpeto.6-Varanus' and sequence.source.name = 'fasta-ehbv-refseqs'"
  exit

#~# Metahepadna EVE aligns
alignment AL_Metahepadna

  extract child AL_eHBV-Meta.1-Sphenodon -r REF_eHBV-Meta.1-Sphenodon
  demote member AL_eHBV-Meta.1-Sphenodon -w "sequence.name = 'eHBV-Meta.1-Sphenodon' and sequence.source.name = 'fasta-ehbv-curated'"
  demote member AL_eHBV-Meta.1-Sphenodon -w "sequence.name = 'eHBV-Meta.1-Sphenodon' and sequence.source.name = 'fasta-ehbv-refseqs'"
  exit
